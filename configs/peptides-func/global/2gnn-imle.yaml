fixed:
  dataset: peptides-func
  log_path: './logs'

  use_wandb: True
  wandb_name: "peptides-func"
  wandb_prefix: "global_2gnn_cat"

  sample_configs:
    sample_policy: global_topk_directed
    sample_k: 20
    ensemble: 1
    include_original_graph: True

  imle_configs:
    sampler: imle
    logits_activation: 'None'
    weight_edges: None
    marginals_mask: True
    num_val_ensemble: 20
    num_train_ensemble: 1
    negative_sample: "full"

    model: "transformer"
    heads: 4   # see GraphGPS https://github.com/rampasek/GraphGPS/blob/main/configs/GPS/zinc-GPS-LapPE%2BRWSE.yaml#L51
    rwse:
      kernel: 20
      layers: 2
      dim_pe: 16
      raw_norm_type: 'BatchNorm'

    lap:
      max_freqs: 4
      dim_pe: 16
      layers: 2
      raw_norm_type: null

    emb_hid_size: 64
    emb_optim: "adamw"
    emb_scheduler: "cosine"
    tf_layer: 2
    dropout: 0.
    attn_dropout: 0.5
    embd_lr: 1.e-3
    reg_embd: 0.
    layernorm: False
    batchnorm: True
    spectral_norm: True   # spectral normalization
    micro_batch_embd: 1
    noise_scale: 0.3
    beta: 10.

    auxloss:
      variance: 0.
      degree: 0.
      origin_bias: 0.1
  
  input_feature: 64
  rwse:
    kernel: 20
    layers: 2
    dim_pe: 16
    raw_norm_type: 'BatchNorm'
  lap:
    max_freqs: 4
    dim_pe: 16
    layers: 2
    raw_norm_type: null

  optim: "adam"
  model: pep_gin_duo
  hid_size: 256
  lr: 1.e-3
  lr_decay:
    scheduler: step
    steps: '[ 400, 600 ]'
  early_stop:
    patience: 100
    target: val_metric
  reg: 0.
  num_convlayers: 4
  mlp_layers_intragraph: 3
  mlp_layers_intergraph: 2
  inter_graph_pooling: 'cat'
  batch_size: 8
  min_epochs: 700
  max_epochs: 1000
  data_path: './datasets'
  debug: False
  num_runs: 2
